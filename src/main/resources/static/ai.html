<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>AI家庭医生</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f7fa;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .header h1 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .header p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* 新增返回按钮样式 */
        .back-button {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }

        .back-button:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .back-button::after {
            content: "←";
            font-size: 1.2rem;
            color: white;
        }

        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .message {
            max-width: 80%;
            padding: 0.8rem 1rem;
            border-radius: 18px;
            line-height: 1.5;
            position: relative;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .user-message {
            align-self: flex-end;
            background-color: #667eea;
            color: white;
            border-bottom-right-radius: 5px;
        }

        .ai-message {
            align-self: flex-start;
            background-color: #ffffff;
            color: #333;
            border: 1px solid #e0e0e0;
            border-bottom-left-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .input-area {
            padding: 1rem;
            background-color: white;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 0.5rem;
        }

        .message-input {
            flex: 1;
            padding: 0.8rem 1rem;
            border: 1px solid #ddd;
            border-radius: 24px;
            outline: none;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .message-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
        }

        .send-button {
            padding: 0.8rem 1.5rem;
            background-color: #667eea;
            color: white;
            border: none;
            border-radius: 24px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.3s;
        }

        .send-button:hover {
            background-color: #5a6fd8;
        }

        .send-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        .typing-indicator {
            align-self: flex-start;
            background-color: #ffffff;
            color: #333;
            border: 1px solid #e0e0e0;
            border-bottom-left-radius: 5px;
            padding: 0.8rem 1rem;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background-color: #999;
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) {
            animation-delay: 0s;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-5px);
            }
        }

        .timestamp {
            font-size: 0.7rem;
            opacity: 0.7;
            margin-top: 0.3rem;
            text-align: right;
        }

        .model-selector {
            display: flex;
            justify-content: center;
            gap: 1rem;
            padding: 1rem;
            background-color: #f0f4f8;
            flex-wrap: wrap;
        }

        .model-card {
            padding: 0.8rem 1.2rem;
            background-color: white;
            border-radius: 12px;
            cursor: pointer;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
            text-align: center;
            min-width: 120px;
        }

        .model-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .model-card.active {
            border-color: #667eea;
            background-color: #e9ecef;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
        }

        .model-card h3 {
            font-size: 1rem;
            margin-bottom: 0.3rem;
            color: #333;
        }

        .model-card p {
            font-size: 0.8rem;
            color: #666;
        }
    </style>
</head>
<body>
<div class="header">
    <!-- 新增返回按钮 -->
    <button class="back-button" onclick="goBack()"></button>
    <h1>AI家庭医生</h1>
    <p>您的24小时智能健康助手</p>
</div>

<div class="model-selector">
    <div class="model-card active" onclick="selectModel('general')">
        <h3>综合医生</h3>
        <p>全科诊疗</p>
    </div>
    <div class="model-card" onclick="selectModel('specialist')">
        <h3>专科医生</h3>
        <p>专业诊断</p>
    </div>
    <div class="model-card" onclick="selectModel('emergency')">
        <h3>急诊医生</h3>
        <p>紧急处理</p>
    </div>
</div>

<div class="chat-container" id="chatContainer">
    <div class="message ai-message">
        您好！我是您的AI家庭医生，可以为您提供健康咨询、疾病诊断建议、用药指导等服务。请问有什么我可以帮助您的吗？
        <div class="timestamp">现在</div>
    </div>
</div>

<div class="input-area">
    <input class="message-input" id="userInput" onkeypress="handleKeyPress(event)" placeholder="请输入您的健康问题..."
           type="text">
    <button class="send-button" onclick="sendMessage()">发送</button>
</div>

<script>
    let currentModel = 'general';

    // 新增返回函数
    function goBack() {
        window.history.back();
    }

    function selectModel(modelName) {
        currentModel = modelName;
        document.querySelectorAll('.model-card').forEach(card => {
            card.classList.remove('active');
        });
        event.currentTarget.classList.add('active');
    }

    function getCurrentTime() {
        const now = new Date();
        return `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
    }

    function createUserMessageElement(text) {
        const messageDiv = document.createElement('div');
        messageDiv.className = 'message user-message';
        messageDiv.innerHTML = `
                ${text}
                <div class="timestamp">${getCurrentTime()}</div>
            `;
        return messageDiv;
    }

    function createAIMessageElement(text) {
        const messageDiv = document.createElement('div');
        messageDiv.className = 'message ai-message';
        messageDiv.innerHTML = `
                ${text}
                <div class="timestamp">${getCurrentTime()}</div>
            `;
        return messageDiv;
    }

    function showTypingIndicator() {
        const typingDiv = document.createElement('div');
        typingDiv.className = 'typing-indicator';
        typingDiv.id = 'typingIndicator';
        typingDiv.innerHTML = `
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            `;
        return typingDiv;
    }

    function handleKeyPress(event) {
        if (event.key === 'Enter') {
            sendMessage();
        }
    }

    function sendMessage() {
        const userInput = document.getElementById('userInput');
        const chatContainer = document.getElementById('chatContainer');

        if (userInput.value.trim() === '') return;

        // 添加用户消息
        const userMessage = createUserMessageElement(userInput.value);
        chatContainer.appendChild(userMessage);

        // 保存用户输入用于后续处理
        const userText = userInput.value;
        userInput.value = '';

        // 显示正在输入指示器
        const typingIndicator = showTypingIndicator();
        chatContainer.appendChild(typingIndicator);
        chatContainer.scrollTop = chatContainer.scrollHeight;

        // 模拟AI响应延迟
        setTimeout(() => {
            // 移除正在输入指示器
            typingIndicator.remove();

            // 生成AI响应
            let response = "";
            if (currentModel === 'general') {
                response = generateGeneralResponse(userText);
            } else if (currentModel === 'specialist') {
                response = generateSpecialistResponse(userText);
            } else if (currentModel === 'emergency') {
                response = generateEmergencyResponse(userText);
            }

            const aiMessage = createAIMessageElement(response);
            chatContainer.appendChild(aiMessage);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }, 1500);
    }

    function generateGeneralResponse(text) {
        const responses = [
            `根据您的描述"${text}"，这可能是常见症状。建议您注意休息，多喝水。如果症状持续或加重，请及时就医。`,
            `您提到的"${text}"需要进一步了解。请问这种症状持续多长时间了？有没有其他伴随症状？`,
            `关于"${text}"的问题，我可以提供一些基础建议。首先，请保持良好的作息习惯，其次注意饮食均衡。`,
            `您的"${text}"情况听起来需要关注。我建议您记录症状变化，并在下次就诊时提供给医生。`,
            `针对"${text}"，我可以为您提供一些健康指导。请详细描述一下症状的具体表现，这样我能给出更准确的建议。`
        ];
        return responses[Math.floor(Math.random() * responses.length)];
    }

    function generateSpecialistResponse(text) {
        const responses = [
            `作为专科医生，针对您的"${text}"情况，这可能涉及特定的医学领域。建议您咨询相关专科医生进行详细检查。`,
            `根据专科医学角度，"${text}"需要专业诊断设备和检查。请尽快预约相关专科门诊进行系统检查。`,
            `您的"${text}"症状需要专科医生的专业评估。建议您携带相关检查资料，前往医院进行进一步诊断。`,
            `从专科角度看，"${text}"可能有多种病因。需要结合具体检查结果才能确定治疗方案。`,
            `针对"${text}"这类专科问题，建议您先进行基础检查，然后携带检查结果咨询专科医生。`
        ];
        return responses[Math.floor(Math.random() * responses.length)];
    }

    function generateEmergencyResponse(text) {
        const responses = [
            `紧急情况！对于"${text}"，如果您现在感觉严重不适，请立即拨打120或前往最近的急诊科！`,
            `根据急诊医学原则，"${text}"如果伴有剧烈疼痛、呼吸困难等症状，需要立即就医。请不要延误！`,
            `WARNING: 如果"${text}"伴随胸痛、意识模糊、严重出血等症状，请立即就医！这是紧急医疗情况。`,
            `紧急提醒：对于"${text}"的急性发作，时间就是生命。请立即寻求专业医疗救助！`,
            `生命体征危急！"${text}"可能需要紧急处理。请立即前往医院急诊科或联系急救服务！`
        ];
        return responses[Math.floor(Math.random() * responses.length)];
    }

    // 页面加载完成后聚焦输入框
    document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('userInput').focus();
    });
</script>
</body>
</html>
